# Text-Based Game

## Игровой процесс

Игровой процесс построен на передвижении героя по карте посредством
ввода текстовых команд:

```
-- N -- сделать шаг на север,

-- W -- сделать шаг на запад,

-- S -- сделать шаг на юг,

-- E -- сделать шаг на восток.
```

Помимо команд передвижения, пользователю доступны следующие запросы:

```
-- D -- отправляет запрос на раскапывание в данной точке
        (механика, нужная для выполнения одного из сюжетных квестов),

-- H -- выводит список доступных команд,

-- J -- выводит историю посещения сюжетных точек,

-- I -- выводит информацию об имеющихся предметах (розы/лекарство),

-- С -- выводит информацию о месте игрока на карте.

-- X -- завершает игру.
```

## Сюжет

Главный герой просыпается в замке и получает задание найти
лекарство для принцессы.

Лекарство приготовить может ведьма. Для этого нужно найти и принести 
ей три морских розы.

Розы герой находит путём исследования карты и использования подсказок
от сюжетных и несюжетных персонажей.

В приготовленное ведьмой зелье нужно будет также добавить воды из фонтана,
что потребует выполнение ещё одного сюжетного квеста.

Игра заканчивается, когда игрок приносит в замок готовое зелье.

## Карта

Карта -- в файле **map.pdf**.

Карта представляет собой прямоугольное поле размера десять на двенадцать
клеток.

С юга и запада игровое пространство ограничено морем.

С севера игровое пространство ограничено горами.

С востока игровое пространство ограничено лесом.

На карте расположены тринадцать сюжетных клеток:

	Замок, Домик Ведьмы, Домик Кикиморы, 
	
	Порт, Домик Леди,
	
	Домик Кузена, Домик Гнома, Шахта Гнома, Хранилище на берегу,
	
	Домик Горыныча,
	
	Фонтан, Домик трубопроводчика, Склад.

## Текущая версия игры

На карте представлены граничные клетки и две сюжетных: 
Замок и Домик Ведьмы.

Пользователю доступны все команды (кроме Journal, для которой будет
выведено сообщение об отсутствии реализации).

Пользователь может передвигаться в любую сторону света.
 
При попытке перейти на граничную клетку будет выведено сообщение
о преграде.

Пользователь может пройти игру: нужно посетить Домик Ведьмы, которая 
сразу даст зелье, и отнести его обратно в замок.

После этого игра завершится автоматически.

## Внесённые в игру изменения

- Новый файл MapData.h, хранящий данные клеток карты
и сюжетные зависимости:
  - в namespace coordinates -- координаты сюжетных клеток,
  - в namespace messages -- векторы сообщений, выдаваемых клетками,
  - в namespace visits -- сюжетные зависимости.
- Карта теперь собирается из однотипных клеток с полями 
reachable_, state_ и messages_. Отказ от наследования.
- Замена C-указателей на умные указатели.
- Добавлена возможность выхода из игры (команда Exit).
- Добавлена реализация команд Dig, Help, Inventory, Coordinates.
- Проработана механика передвижения по карте.

  Переход к новой клетке теперь вызывает внутреннюю команду CommandAction,
  которая вызывает CommandAction для конкретной клетки.

  (CommandAction%CellName%
  для сюжетных клеток и CommandActionBlank для пустых клеток).

- Незначительные изменения:
  - Добавлены и отредактированы выводимые сообщения.
  - Добавлены функции для вывода сообщений в реализованных командах.
  - Добавлена функция GetCurrentCell() для обращения к текущей клетке.
  - Логика координат x и y в реализации заменена на логику строк
    и столбцов в массиве.
- Дополнены и отредактированы файлы **README.md**, **uml.pdf** и **map.xlsx**.

## Реализация

Архитектура проекта -- в файле **uml.pdf**.

Model-View-Controller паттерн.

Паттерн Command для реализации запросов в Controller`е.

## Сборка

Сборка проекта осуществляется на CMake.

Для запуска проекта следует выполнить следующие команды:

```
mkdir build
cd build
cmake ..
cd ..
./bin/TextBasedGame
```
